<!doctype html>
<html>
<head lang="fr">
<meta charset="utf-8"/>
<title>Documentation de l'extension Owebia-Shipping 2.5.22</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="http://netdna.bootstrapcdn.com/bootstrap/3.0.0-rc1/css/bootstrap.min.css" rel="stylesheet">
<style>
body{padding-top:60px}
.navbar-inverse{background:navy}
.navbar-inverse .navbar-nav >.active > a,
.navbar-inverse .navbar-nav > .active > a:hover,
.navbar-inverse .navbar-nav > .active > a:focus{background-color:#040819}

.highlight{color:navy}
#index ul{padding-left:1.5em}
span.code{padding:0 3px;color:#006f91;font-weight:bold}
span.strike{text-decoration:line-through}
pre.changelog{white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;white-space:pre-wrap;word-wrap:break-word;word-break:normal}

/* json */
.json-property { color: #444; }
.json-id       { color: #09f; }
.json-numeric  { color: #f50; }
.json-reserved { color: blue; }
.json-string   { color: purple; }
.json-meta .json-string   { color: #666; }
.json-about .json-string  { color: #666; }

/* sidebar */
.sidebar.affix {position: static;}
.sidenav {margin-top:30px;margin-bottom:30px;padding-top:10px;padding-bottom:10px;text-shadow:0 1px 0 #fff;background-color:#f6f6f6;border-radius:5px;}
.sidebar .nav > li > a {display:block;color:#716b7a;padding:5px 20px;}
.sidebar .nav > li > a:hover,
.sidebar .nav > li > a:focus {text-decoration:none;background-color:#e5e3e9;border-right:4px solid #dbd8e0;}
.sidebar .nav > .active > a,
.sidebar .nav > .active:hover > a,
.sidebar .nav > .active:focus > a {font-weight:bold;color:navy;background-color:transparent;border-right:4px solid navy;}
.sidebar .nav .nav {display: none; /* Hide by default, but at >768px, show it */margin-bottom: 8px;}
.sidebar .nav .nav > li > a {padding-top:3px;padding-bottom:3px;padding-left:30px;font-size:90%;}
@media screen and (min-width: 768px) {
    .sidebar{display:block}
    .sidebar .nav > .active > ul {display:block}
    .bs-navbar-top-example .navbar-fixed-top,
    .bs-navbar-bottom-example .navbar-fixed-bottom {position:absolute}
}
@media screen and (min-width: 992px) {
    .sidebar.affix,
    .sidebar.affix-bottom {width:213px}
    .sidebar.affix {position:fixed;top:80px}
    .sidebar.affix-bottom {position:absolute}
    .sidebar.affix-bottom .sidenav,
    .sidebar.affix .sidenav {margin-top:0;margin-bottom:0}
}
@media screen and (min-width: 1200px) {
    .sidebar.affix-bottom,
    .sidebar.affix {width:270px}
}
</style>
</head>
<body>
<div class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <a href="http://www.owebia.com" class="navbar-brand">Owebia</a>
        <ul class="nav navbar-nav">
        </ul>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col-lg-3">
            <div class="affix sidebar">
                <!-- doc sidebar start -->
                <ul class="nav sidenav">
                    <li><a href="#introduction">Introduction</a></li>
                    <li><a href="#examples">Exemples</a>
                        <ul class="nav">
                            <li><a href="#examples_simple">Exemple simple : port offert</a></li>
                            <li><a href="#examples_using_address_filters">Frais relatifs à la destination</a></li>
                            <li><a href="#examples_using_customer_groups">Frais relatifs au groupe client</a></li>
                            <li><a href="#examples_using_formulas">Utiliser les formules</a></li>
                            <li><a href="#examples_using_special_functions">Utiliser les fonctions spéciales</a></li>
                            <li><a href="#examples_using_foreach">Utiliser les boucles <code>{foreach …}</code></a></li>
                            <li><a href="#examples_using_array_functions">Manipuler les tableaux</a></li>
                            <li><a href="#examples_more">Autres exemples</a></li>
                        </ul>
                    </li>
                    <li><a href="#definitions">Définitions</a>
                        <ul class="nav">
                            <li><a href="#definitions_element">Les éléments</a></li>
                            <li><a href="#definitions_property">Les propriétés</a></li>
                            <li><a href="#definitions_unique_id">L'identifiant unique</a></li>
                        </ul>
                    </li>
                    <li><a href="#formulas">Les formules</a>
                        <ul class="nav">
                            <li><a href="#formulas_variables">Les variables</a></li>
                            <li><a href="#formulas_functions">Les fonctions</a></li>
                            <li><a href="#formulas_special_functions">Les fonctions spéciales</a></li>
                            <li><a href="#formulas_foreach">Les boucles <code>foreach</code></a></li>
                            <li><a href="#formulas_deprecated_variables">Les variables dépréciées</a></li>
                        </ul>
                    </li>
                    <li><a href="#more">Divers</a>
                        <ul class="nav">
                            <li><a href="#more_tracking_url">L'URL de suivi</a></li>
                        </ul>
                    </li>
                    <li><a href="#changelog">Changelog</a></li>
                    <li><a href="#index">Index</a></li>
                </ul>
                <!-- doc sidebar end -->
            </div>
        </div>
        <div class="col-lg-9">
            <!-- doc content start -->
            <h1>Documentation de l'extension Owebia-Shipping 2.5.20 pour Magento</h1>
            <div id="introduction">
                <h2>Introduction</h2>

                <p>Owebia-Shipping est une extension pour la solution de e-commerce <a href="http://www.magentocommerce.com/" target="_blank">Magento</a>.</p>
                <p>Grace à sa syntaxe au format <a href="http://fr.wikipedia.org/wiki/JavaScript_Object_Notation" target=_blank>JSON</a>, cette extension permet une grande souplesse dans le paramétrage des frais de livraison.</p>
                
                <p>Cette documentation explique comment créer une configuration pour l'un des modes de livraison proposé par l'extension.</p>
                
                <p class="alert alert-info">Nouvelle documentation, plus simple et plus claire.<br/>
                <strong>Utilisez l'<a href="#index">index</a></strong> pour vous retrouver plus facilement dans la documentation.</p>
            </div>

            <div id="examples">
                <h2>Exemples</h2>

                <div id="examples_simple">
                    <h3>Exemple simple : port offert</h3>
                    <div class="json">{
                    "__auto__":{"label":"Livraison gratuite","fees": 0}
                    }</div>
                </div>

                <div id="examples_using_address_filters">
                    <h3>Frais relatifs à la destination</h3>
                    <div class="json">{
                    "__auto__":{"label":"France, Allemagne, Suisse, Espagne, Italie","shipto":"FR,DE,CH,ES,IT","fees":10},
                    "__auto__":{"label":"France sauf la Corse","shipto":"FR-(2A,2B)","fees":10},
                    "__auto__":{"label":"Corse","shipto":"FR(2A,2B)","fees":10},
                    "__auto__":{"label":"Monde entier sauf l'Allemagne et la Corse","shipto":"* - ( DE, FR(2A,2B) )","fees":10}
                    }</div>

                    <h4>Utiliser le caractère jocker <code>*</code> ou les expressions régulières</h4>
                    <div class="json">{
                    "__auto__":{"label":"Caractère jocker autorisant les codes postaux commençant par 25","shipto":"FR(25*)","fees":10},
                    "__auto__":{"label":"Expression régulière acceptant les codes postaux commençant par 'PO', 'po', 'Po' ou 'pO'","shipto":"GB(/^PO.*$/i)","fees":10}
                    }</div>

                    <div id="examples_excluding_domtom_postcode">
                        <h4>Bloquer la livraison vers la France mais avec un code postal DOM/TOM</h4>
                        <p>Avec l'expression régulière suivante, vous bloquez les codes postaux commançant par 97 ou 98 (avec ou sans zéros et espaces intercalés).</p>
                        <div class="json">{
                        "__auto__":{"label":"Expression régulière refusant les codes postaux commençant par 97 et 98","shipto":"FR-(/^[0\\s]*9\\s*[78].*/)","fees":10}
                        }</div>
                    </div>

                    <div id="examples_using_address_filters_shortcuts">
                        <h4>Utilisation des raccourcis <code>address_filter</code></h4>
                        <div class="json">{
                        "__auto__":{"label":"Europe sauf la France","shipto":"({address_filter.EU-27}) - (FR)","fees":10}
                        }</div>
                    </div>
                </div>

                <div id="examples_using_customer_groups">
                    <h3>Frais relatifs au groupe client</h3>
                    <p>On peut utiliser le nom ou l'ID des groupes client.</p>
                    <div class="json">{
                    "__auto__":{"label":"Groupes NOT LOGGED IN et General","customer_groups":"NOT LOGGED IN,General","fees":10},
                    "__auto__":{"label":"Groupes NOT LOGGED IN et General par leur ID","customer_groups":"0,1","fees":10},
                    "__auto__":{"label":"Groupe Retailer","customer_groups":"Retailer","fees":10}
                    }</div>
                </div>

                <div id="examples_using_formulas">
                    <h3>Utiliser les formules</h3>
                    <p>Les formules peuvent être utilisées dans les propriétés <code>conditions</code> et <code>fees</code>.</p>
                    <div class="json">{
                    "__auto__":{"label":"Livraison","fees":"0.1 * {cart.price-tax+discount} + 10.00"}
                    }</div>

                    <h4>Copier la propriété d'un autre élément</h4>
                    <div class="json">{
                    "standard":{"label":"Livraison standard","conditions":"{cart.price-tax+discount} < 1000.00","fees":10},
                    "express":{"label":"Livraison express","conditions":"( {standard.conditions} ) && ( {cart.weight} < 10 )","fees":12}
                    }</div>

                    <h4>Utiliser la fonction <code>min()</code></h4>
                    <div class="json">{
                    "__auto__":{"label":"Livraison","fees":"min({cart.weight}, {cart.price+tax+discount}, {cart.qty})"}
                    }</div>

                    <h4>Utiliser la fonction <code>range()</code></h4>
                    <div class="json">{
                    "__auto__":{"label":"Livraison","conditions":"range({cart.weight}, 1.0, 3.0)","fees":10}
                    }</div>

                    <h4>Utiliser la fonction <code>substr()</code></h4>
                    <p>Une variable de type chaîne de caractères doit être entourée par des guillemets simples sauf si on utilise l'auto-échappement avec les caractères <code>{{</code> et <code>}}</code>.</p>
                    <div class="json">{
                    "__auto__":{"label":"Sans utiliser l'auto-échappement","conditions":"substr('{cart.coupon_code}', 0, 5)=='free_'","fees":10},
                    "__auto__":{"label":"En utilisant l'auto-échappement","conditions":"substr({{cart.coupon_code}}, 0, 5)=='free_'","fees":10}
                    }</div>

                </div>

                <div id="examples_using_special_functions">
                    <h3>Utiliser les fonctions spéciales</h3>

                    <div id="examples_special_table">
                        <h4>Utilisation de la fonction spéciale <code>{table … in …}</code></h4>
                        <div class="json">{
                        "__auto__":{"label":"Livraison","fees":"{table {cart.weight} in 0.5:5.30, 1.0:6.50, 2.0:7.40, 3.0:8.30, 5.0:10.10}"}
                        }</div>
                        <p>
                            Dans une <code>table</code>, on peut inclure ou exclure une valeur limite avec les caractères <code>[</code> et <code>]</code> :
                        </p>
                        <div class="json">{
                        "__auto__":{"label":"Limite supérieure incluse","fees":"{table {cart.weight} in 1.0]:5.00}"},
                        "__auto__":{"label":"Limite supérieure exclue","fees":"{table {cart.weight} in 1.0[:5.00}"}
                        }</div>

                        <p>
                            Dans une <code>table</code>, on doit spécifier la valeur de référence. Pour cela, on peut utiliser une des <a href="#formulas_variables">variables</a> disponibles.<br/>
                            On peut aussi utiliser une formule afin de définir une autre variable de référence.
                        </p>

                        <div class="json">{
                        "__auto__":{"label":"Table avec poids du panier","fees":"{table {cart.weight} in 0.5:5.30, 1.0:6.50}"},
                        "__auto__":{"label":"Table avec quantité d'articles","fees":"{table {cart.qty} in 10:5.30, 20:6.50}"},
                        "__auto__":{"label":"Table avec prix TTC","fees":"{table {cart.price+tax+discount} in 15.00:5.30, 30.00:6.50, *:10.00}"},
                        "__auto__":{"label":"Table avec prix HT","fees":"{table {cart.price-tax+discount} in 15.00:5.30, 30.00:6.50, *:10.00}"},
                        "__auto__":{"label":"Table avec valeur personnalisée","fees":"{table ceil({cart.weight}/10) in 1:5.30, 2:6.50}"}
                        }</div>
                    </div>

                    <div id="examples_special_switch">
                        <h4>Utilisation de la fonction spéciale <code>{switch … in …}</code> (table de correspondance)</h4>
                        <p>
                            Dans un <code>switch</code>, on doit spécifier la valeur de référence. Pour cela, on peut utiliser une des <a href="#formulas_variables">variables</a> disponibles.<br/>
                            On peut aussi utiliser une formule afin de définir une autre variable de référence.
                        </p>
                        <div class="json">{
                        "__auto__":{"label":"Switch avec code promo","fees":"{switch {{cart.coupon_code}} in 'coupon1':5.30, 'coupon2':6.50, null:10.00, *:7.50}"},
                        "__auto__":{"label":"Switch avec pays de livraison","fees":"{switch {{shipto.country_id}} in 'FR':5.30, 'BE':6.50, 'DE':10.00, *:7.50}"}
                        }</div>
                    </div>

                    <div id="examples_special_count">
                        <h4>Utiliser la fonction spéciale <code>{count …}</code></h4>
                        <div class="json">{
                        "__auto__":{"label":"Si au moins un produit possède l'attribut 'color' égal à 'Bleu'","conditions":"{count items where product.attribute.color=='Bleu'} > 0","fees":10},
                        "__auto__":{"label":"Si tous les produits possèdent l'option 'size' supérieure ou égal à '1'","conditions":"{count items where item.option.size>='1'} == {cart.qty}","fees":10}
                        }</div>

                        <p>
                            Si la propriété est de type <strong>Oui/Non</strong>, vous devez utiliser les valeurs <code>true</code>/<code>false</code> ou <code>1</code>/<code>0</code> sans les guillemets.
                        </p>
                        <div class="json">{
                        "__auto__":{"label":"Exemple propriété de type Oui/Non : 1","conditions":"{count items where product.attribute.colissimo_allowed==1}","fees":10},
                        "__auto__":{"label":"Exemple propriété de type Oui/Non : true","conditions":"{count items where product.attribute.colissimo_allowed==true}","fees":10}
                        }</div>
                    </div>

                    <div id="examples_special_count_distinct">
                        <h4>Utiliser la fonction spéciale <code>{count distinct …}</code></h4>
                        <div class="json">{
                        "__auto__":{"label":"Nombre de SKU différents","conditions":"{count distinct product.attribute.sku}","fees":10}
                        }</div>
                    </div>

                    <div id="examples_special_sum">
                        <h4>Utiliser la fonction spéciale <code>{sum …}</code></h4>
                        <div class="json">{
                        "__auto__":{"label":"Somme de toutes les options 'size' est supérieure à 30","conditions":"{sum item.option.size} > 30","fees":10}
                        }</div>
                    </div>

                    <div id="examples_special_min">
                        <h4>Utiliser la fonction spéciale <code>{min …}</code></h4>
                        <div class="json">{
                        "__auto__":{"label":"Prix HT sans remise minimum des articles dans le panier est supérieur à 10","conditions":"{min item.price-tax-discount} > 10","fees":10}
                        }</div>
                    </div>

                    <div id="examples_special_max">
                        <h4>Utiliser la fonction spéciale <code>{max …}</code></h4>
                        <div class="json">{
                        "__auto__":{"label":"Valeur maximum de l'option 'size' des articles dans le panier est inférieure à 50","conditions":"{max item.option.size} < 50","fees":10}
                        }</div>
                    </div>
                </div>

                <div id="examples_using_foreach">
                    <h3>Utiliser les boucles <code>{foreach …}</code></h3>
                    <div class="json">{
                    "__auto__":{"label":"Regroupement des produits par origine puis traitement des groupes séparémment","fees":"{foreach product.attribute.code_origin}{table {selection.weight} in 0.0:0.00, 1.0:11.00, 3.0:12.00, 5.0:13.00}{/foreach}"},
                    "__auto__":{"label":"Calcul des frais de port par produit","fees":"{foreach product.attribute.sku}{product.attribute.shipping}*{item.qty}{/foreach}"}
                    }</div>
                </div>

                <div id="examples_using_array_functions">
                    <h3>Manipuler les tableaux</h3>

                    <h4>Utilisation de la fonction <code>in_array()</code></h4>
                    <div class="json">{
                    "__auto__":{"label":"Livraison","conditions":"in_array({cart.qty}, array(10, 20, 30))","fees":10}
                    }</div>

                    <h4>Utilisation de la fonction <code>in_array()</code> avec des chaînes de caractères *</h4>
                    <div class="json">{
                    "__auto__":{"label":"Livraison","conditions":"in_array({{cart.coupon_code}}, array('free1', 'free2'))","fees":10}
                    }</div>

                    <h4>Utilisation de la fonction <code>array_match_any()</code></h4>
                    <div class="json">{
                    "__auto__":{"label":"Livraison","about":"5 x poids des produits qui se trouvent dans la catégorie 2 ou 3","fees":"{sum product.weight where array_match_any(product.categories.id, array(2, 3))} * 5.0"}
                    }</div>

                    <h4>Utilisation de la fonction <code>array_match_all()</code></h4>
                    <div class="json">{
                    "__auto__":{"label":"Livraison","about":"5 x poids des produits qui se trouvent à la fois dans la catégorie 2 et dans la catégorie 3","fees":"{sum product.weight where array_match_all(product.categories.id, array(2, 3))} * 5.0"}
                    }</div>
                </div>

                <div id="examples_more">
                    <h3>Autres exemples</h3>

                    <div id="examples_product_categories">
                        <h4>Utiliser la catégorie des produits</h4>
                        <p class="alert alert-danger">Attention, il est à noter que dans Magento, <strong>un produit peut être dans plusieurs catégories</strong>. Faites donc particulièrement attention à la façon dont vous utilisez cette propriété.</p>
                        <div class="json">{
                        "__auto__":{"label":"Boucle foreach dont l'itération se fait sur la catégorie","fees":"{foreach product.categories}{selection.weight}{/foreach}"},
                        "__auto__":{"label":"Utilisation de la catégorie à l'intérieur d'une boucle foreach","fees":"{foreach product.sku}({{product.category}}=='Test' ? 2.00 : 1.00)*{item.qty}{/foreach}"},
                        "__auto__":{"label":"Utilisation de l'id de la catégorie à l'intérieur d'une boucle foreach","fees":"{foreach product.sku}({product.category.id}==12 ? 2.00 : 1.00)*{item.qty}{/foreach}"},
                        "__auto__":{"about":"La fonction in_array() est utilisée car product.categories retourne un tableau","label":"Somme des attributs weight des produits de la catégorie 'Test'","fees":"{sum product.weight where in_array('Test', product.categories)}"},
                        "__auto__":{"about":"La fonction in_array() est utilisée car product.categories.id retourne un tableau","label":"Somme des attributs weight des produits de la catégorie dont l'id est 12","fees":"{sum product.weight where in_array(12, product.categories.id)}"},
                        "__auto__":{"about":"La fonction array_match_any() est utilisée car product.categories.id retourne un tableau","label":"Somme des attributs weight des produits des catégories dont les id sont 11 et 12","fees":"{sum product.weight where array_match_any(product.categories.id, array(11, 12))}"},
                        "__auto__":{"label":"Somme des poids des produits dont la première catégorie est 'Test'","fees":"{sum product.weight where product.category=='Test'}"},
                        "__auto__":{"label":"Somme des poids des produits dont l'id de la première catégorie est 12","fees":"{sum product.weight where product.category.id==12}"}
                        }</div>
                    </div>

                    <div id="examples_data">
                        <h4>Ajout et utilisation d'un élément <code>data</code></h4>
                        <p>Un élément de type <code>data</code> permet de spécifier des données utilisables dans les méthodes de livraison.</p>
                        <div class="json">{
                        "mydata":{"type":"data","var1":"12"},
                        "__auto__":{"label":"Livraison","shipto":"FR","fees": "{mydata.var1}"},
                        "__auto__":{"label":"Livraison","shipto":"DE","fees": "{mydata.var1}*1.5"}
                        }</div>
                    </div>

                    <div id="examples_meta">
                        <h4>Ajout d'un élément <code>meta</code></h4>
                        <p>Un élément de type <code>meta</code> permet d'ajouter des données informatives (auteur, date…).</p>
                        <div class="json">{
                        "about":{"type":"meta","author":"Owebia","date":"15/07/2013","about":"Tarifs 2013"}
                        }</div>
                    </div>
                </div>
            </div>

            <div id="definitions">
                <h2>Définitions</h2>
                <p>
                    La configuration d'un mode de livraison est un objet JSON contenant plusieurs <strong><a href="#definitions_property">propriétés</a></strong>.<br/>
                    Comme imposé par JSON, chaque propriété a un nom unique, qui servira d'<a href="#definitions_unique_id">identifiant unique</a>.<br/>
                    Chaque propriété constitue un <strong><a href="#definitions_element">élément</a></strong> de configuration (qui est également un objet JSON).<br/>
                </p>
                <div id="definitions_element">
                    <h3>Les éléments</h3>

                    <p>
                        Il existe trois différents types d'<strong>élément</strong> de configuration :
                    </p>
                    <ul>
                        <li><code>method</code> : méthode de livraison (par défaut si non spécifié)</li>
                        <li><code>data</code> : données pouvant être utilisées dans une ou plusieurs méthodes de livraison (<a href="#examples_data">exemples</a>)</li>
                        <li><code>meta</code> : données informatives (<a href="#examples_meta">exemples</a>)</li>
                    </ul>
                </div>

                <div id="definitions_property">
                    <h3>Les propriétés</h3>

                    <p>
                        Chaque élément possède plusieurs <strong>propriétés</strong> :
                    </p>
                    <ul>
                        <li id="property_about"><code>about</code> : commentaire sur l'élément</li>
                        <li id="property_type"><code>type</code> : type de l'élément (<code>method</code>, <code>meta</code> ou <code>data</code>)</li>
                    </ul>

                    <p>
                        Propriétés spécifiques à un élément de type <code>method</code> :
                    </p>
                    <ul>
                        <li id="property_label"><code>label</code> : nom de la méthode de livraison</li>
                        <li id="property_description"><code>description</code> : description (visible seulement si le template l'affiche)</li>
                        <li id="property_enabled"><code>enabled</code> : méthode de livraison activée ou non</li>
                        <li id="property_fees"><code>fees</code> : frais de port</li>
                        <li id="property_conditions"><code>conditions</code> : conditions d'activation</li>
                        <li id="property_shipto"><code>shipto</code> : pays (régions, codes postaux) autorisés à la livraison</li>
                        <li id="property_billto"><code>billto</code> : pays (régions, codes postaux) autorisés à la facturation</li>
                        <li id="property_origin"><code>origin</code> : pays (régions, codes postaux) autorisés en origine</li>
                        <li id="property_customer_groups"><code>customer_groups</code> : groupes de client autorisés</li>
                        <li id="property_tracking_url"><code>tracking_url</code> : URL de suivi (<a href="#more_tracking_url">plus d'informations</a>)</li>
                    </ul>

                    <p><a href="#examples">Voir les exemples</a></p>

                    <h4>Utiliser les propriétés de type adresse (<code>shipto</code>, <code>billto</code> et <code>origin</code>)</h4>
                    <p>
                        Les codes pays utilisés sont ceux de Magento (à priori ils sont les mêmes que les <a href="http://fr.wikipedia.org/wiki/ISO_3166-1" target=_blank>codes ISO 3166-1 alpha-2</a>).<br/>
                        Il est possible de spécifier les codes régions (uniquement avec <code>shipto</code>) ou les codes postaux que l'on veut filtrer ou exclure.
                    </p>
                    <p class=new>
                        Vous pouvez utiliser le caractère <strong>jocker</strong> <code>*</code> ou les <strong>expressions régulières</strong> pour les codes postaux.<br/>
                        Une expression régulière doit commencer et se terminer par le caractère <code>/</code>. Si vous souhaitez utiliser les caractères <code>(</code>, <code>)</code> ou <code>.</code>, vous devez les échapper avec le caractère <code>\</code> (ex: <code><span class=string>"FR(/^25\([0-9]{3}\)$/)"</span></code>).<br/>
                        Vous pouvez utiliser l'option d'insensibilité à la casse (ex: <code><span class=string>"GB(/^PO.*$/i)"</span></code>).
                    </p>

                    <p><a href="#examples_using_address_filters">Voir les exemples</a></p>

                    <div id="address_filter" class="alert alert-info">
                        <p><strong>Astuce</strong><br/>Pour raccourcir la saisie des pays, vous pouvez utiliser les variables suivantes :</p>
                        <ul>
                            <li><code>{address_filter.AF}</code> : pays d'Afrique</li>
                            <li><code>{address_filter.AS}</code> : pays d'Asie</li>
                            <li><code>{address_filter.EU}</code> : pays d'Europe</li>
                            <li><code>{address_filter.NA}</code> : pays d'Amérique du Nord</li>
                            <li><code>{address_filter.SA}</code> : pays d'Amérique du Sud</li>
                            <li><code>{address_filter.OC}</code> : pays d'Océanie</li>
                            <li><code>{address_filter.AN}</code> : pays d'Antartique</li>
                            <li><code>{address_filter.EU-27}</code> : pays de l'Union Européenne</li>
                            <li><code>{address_filter.DOM}</code> : codes pays des département d'Outre-Mer Français</li>
                            <li><code>{address_filter.COM}</code> : codes pays des Collectivités d'Outre-Mer Françaises</li>
                        </ul>
                        <p><a href="#examples_using_address_filters_shortcuts">Voir les exemples</a></p>
                    </div>
                </div>

                <div id="definitions_unique_id">
                    <h3>L'identifiant unique</h3>

                    <p>Chaque élément de configuration possède un <strong>identifiant unique</strong>. Cet identifiant permet ensuite de faire référence à l'élément.</p>
                    <p>Exemple :</p>
                    <div class="json">{
                    "europe":{"label":"Livraison Europe","fees":10},
                    "us":{"label":"Livraison US","fees":"{europe.fees}+20"}
                    }</div>

                    <p class="alert alert-danger"><strong><u>Attention</u> :</strong> pour éviter les conflicts, n'utiliser que les caractères <code>a-z</code>, <code>A-Z</code>, <code>0-9</code>, <code>-</code> et <code>_</code> pour former l'identifiant unique.<br/>Vous devez également éviter les identifiants qui correspondent déjà à des noms de variable (<code>cart</code>, <code>product</code>, <code>item</code>…).</p>
                </div>
            </div>

            <div id="formulas">
                <h2>Les formules</h2>
                <p>
                    Les propriétés <code>fees</code> et <code>conditions</code> sont spécifiées sous la forme de formules.<br/>
                </p>
                <p>
                    Une formule utilise des <a href="#formulas_variables">variables</a>, des <a href="#formulas_functions">fonctions</a>, des <a href="#formulas_special_functions">fonctions spéciales</a> et des opérateurs mathématiques.
                </p>
                <p>
                    Opérateurs mathématiques disponibles :
                </p>
                <ul>
                    <li>opérateurs : <code>*</code>, <code>/</code>, <code>+</code> et <code>-</code></li>
                    <li>modulo : <code>%</code></li>
                    <li>parenthèses : <code>(</code> et <code>)</code></li>
                    <li>les opérateurs booléens <code>&amp;&amp;</code>, <code>and</code>, <code>||</code>, <code>or</code>, <code>==</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code></li>
                    <li>les opérateurs binaires <code>&amp;</code> et <code>|</code></li>
                    <li>le groupe d'opérateur <code>C ? X : Y</code> (ex: <code><span class=string>"{cart.price_exluding_tax}&gt;100 ? 15*{cart.weight} : 20*{cart.weight}"</span></code>)</li>
                </ul>
                <p>
                    Vous avez la possibilité de mettre des espaces et des retours à la ligne dans les formules (pour aérer).
                </p>
                <p>
                    Possibilité d'utiliser les fonctionnalités avancées suivantes : casting  en entier <code>(int)</code> ou en nombre flottant <code>(float)</code>,
                    comparaison avec la valeur <code>null</code> ou les valeurs booléennes <code>true</code> et <code>false</code>.
                </p>

                <div id="formulas_variables">
                    <h3>Les variables</h3>

                    <p class="alert alert-info">
                        Lorsque vous utilisez des variables qui ne sont pas numériques ou booléennes, vous devez les échapper avec des guillemets simples ou utiliser la syntaxe d'auto-échappement <code>{{ }}</code>.
                    </p>

                    <p>
                        Les variables suivantes peuvent être utilisées dans les <a href="#formulas">formules</a>.
                    </p>
                    <ul>
                        <li id="formulas_variables_cart">Le panier :
                            <ul>
                                <li><code>{cart.weight}</code> : poids des marchandises</li>
                                <li><code>{cart.qty}</code> : la quantité d'articles</li>
                                <li><code>{cart.price-tax+discount}</code> : prix HT avec remise</li>
                                <li><code>{cart.price+tax+discount}</code> : prix TTC avec remise</li>
                                <li><code>{cart.price-tax-discount}</code> : prix HT sans remise</li>
                                <li><code>{cart.price+tax-discount}</code> : prix TTC sans remise</li>
                                <li><code>{cart.coupon_code}</code> : coupon de réduction</li>
                                <li><code>{cart.free_shipping}</code> : frais de port offert (par une règle dans Magento) [true/false]</li>
                                <li><code>{cart.weight_unit}</code> : l'unité de poids</li>
                                <li><code>{cart.weight_for_charge}</code> : poids des marchandises dont la livraison n'est pas offerte (par les règles de prix panier de Magento)</li>
                            </ul>
                        </li>
                        <li id="formulas_variables_quote">Le bon de commande :
                            <ul>
                                <li><code>{quote.subtotal}</code>: sous-total HT</li>
                                <li><code>{quote.subtotal_with_discount}</code>: sous-total HT avec remise</li>
                                <li><code>{quote.grand_total}</code>: total TTC avec remise</li>
                                <li><code>{quote.base_subtotal}</code>: sous-total HT dans la devise de base</li>
                                <li><code>{quote.base_subtotal_with_discount}</code>: sous-total HT avec remise dans la devise de base</li>
                                <li><code>{quote.base_grand_total}</code>: total TTC avec remise dans la devise de base</li>
                            </ul>
                        </li>
                        <li id="formulas_variables_customer_group">Le group client :
                            <ul>
                                <li><code>{customer_group.id}</code> : id du groupe client</li>
                                <li><code>{customer_group.code}</code> : nom du groupe client</li>
                                <li><code>{customer_group.*}</code> : propriété du groupe client (ex: <code>{customer_group.tax_class_id}</code>)</li>
                            </ul>
                        </li>
                        <li id="formulas_variables_customer">Le client :
                            <ul>
                                <li><code>{customer.id}</code> : id du client</li>
                                <li><code>{customer.attribute.*}</code> : attribut du client (ex: lastname, firstname, group_id…)</li>
                                <li><code>{customer.attribute.*.value}</code> : dans le cas des attributs de type liste de sélection, <code>{customer.attribute.*}</code> retourne l'id, pour obtenir la valeur il faut utiliser <code>{customer.attribute.*.value}</code></li>
                                <li><code>{customer.*}</code> : identique à <code>{customer.attribute.*}</code>, sauf si la variable est déjà définie (ex: <code>{customer.id}</code> est déjà définie)</li>
                            </ul>
                        </li>
                        <li id="formulas_variables_customvar">Les variables personnalisées ou `Custom Variables` (depuis la version 1.4.0.1 de Magento) :
                            <ul>
                                <li><code>{customvar.*}</code> : variable personnalisée de Magento (ex: <code>{customvar.my_var}</code>)</li>
                            </ul>
                        </li>
                        <li id="formulas_variables_shipto">L'adresse de livraison :
                            <ul>
                                <li><code>{shipto.country_name}</code> : le nom du pays</li>
                                <li><code>{shipto.country_id}</code> : le code du pays</li>
                                <li><code>{shipto.region_id}</code> : l'id de la région</li>
                                <li><code>{shipto.region_code}</code> : le code de la région</li>
                                <li><code>{shipto.street}</code> : la rue</li>
                                <li><code>{shipto.city}</code> : la ville</li>
                                <li><code>{shipto.postcode}</code> : le code postal</li>
                            </ul>
                        </li>
                        <li id="formulas_variables_billto">L'adresse de facturation :
                            <ul>
                                <li><code>{billto.country_name}</code> : le nom du pays</li>
                                <li><code>{billto.country_id}</code> : le code du pays</li>
                                <li><code>{billto.postcode}</code> : le code postal</li>
                                <li><code>{billto.*}</code> : propriété de l'adresse de facturation (ex: <code>{billto.city}</code>)</li>
                            </ul>
                        </li>
                        <li id="formulas_variables_origin">L'adresse d'envoi :
                            <ul>
                                <li><code>{origin.country_name}</code> : le nom du pays</li>
                                <li><code>{origin.country_id}</code> : le code du pays</li>
                                <li><code>{origin.region_id}</code> : l'id de la région</li>
                                <li><code>{origin.city}</code> : la ville</li>
                                <li><code>{origin.postcode}</code> : le code postal</li>
                            </ul>
                        </li>
                        <li id="formulas_variables_store">Le magasin :
                            <ul>
                                <li><code>{store.id}</code> <code>{store.code}</code> <code>{store.name}</code> <code>{store.address}</code> <code>{store.phone}</code> : id, code, nom, adresse et téléphone du magasin</li>
                            </ul>
                        </li>
                        <li id="formulas_variables_date">La date courante :
                            <ul>
                                <li><code>{date.timestamp}</code> : timestamp UNIX de la date actuelle</li>
                                <li><code>{date.year}</code> <code>{date.month}</code> <code>{date.day}</code> <code>{date.hour}</code> <code>{date.minute}</code> <code>{date.second}</code> : année, mois, jour, heure, minute et seconde de la date actuelle</li>
                                <li><code>{date.weekday}</code> : jour de la semaine de la date actuelle de 0 (dimanche) à 6 (samedi)</li>
                            </ul>
                        </li>
                        <li id="formulas_variables_request">L'objet <code>request</code> :
                            <ul>
                                <li><code>{request.*}</code> : propriété de l'objet request (Mage_Shipping_Model_Rate_Request) passé en paramètre par Magento (ex: <code>{request.package_qty}</code>). Utiliser l'option "Déboguage" pour obtenir plus de détail sur les propriétés disponibles.</li>
                            </ul>
                        </li>
                    </ul>
                    
                    <div id="formulas_variables_for_special_functions">
                        <h4>Variables utilisables dans les fonctions spéciales</h4>

                        <p>Les variables suivantes peuvent être utilisées dans les <a href="#formulas_special_functions">fonctions spéciales</a>.</p>

                        <p class="alert alert-danger">Contrairement à ailleurs, les variables suivantes ne doivent pas être entourées par les caractères <code>{</code> et <code>}</code>.</p>

                        <p>
                            Un <code>item</code> est une déclinaison d'un <code>product</code> auquel on a ajouté d'éventuelles options. Chaque <code>item</code> a une quantité.
                        </p>
                        <ul>
                            <li id="formulas_variables_item">L'article (ou <code>item</code>) :
                                <ul>
                                    <li><code>item.qty</code> : quantité dans le panier</li>
                                    <li><code>item.price-tax+discount</code> : le prix HT avec remise</li>
                                    <li><code>item.price-tax-discount</code> : le prix HT sans remise</li>
                                    <li><code>item.price+tax+discount</code> : le prix TTC avec remise</li>
                                    <li><code>item.price+tax-discount</code> : le prix TTC sans remise</li>
                                    <li><code>item.option.*</code> : option (la liste des options disponibles dépendra des produits)</li>
                                </ul>
                            </li>
                            <li id="formulas_variables_product">Le produit (ou <code>product</code>) :
                                <ul>
                                    <li><code>product.attribute.*</code> : attribut<br/>Attributs intéressants :
                                        <ul>
                                            <li><code>sku</code> : la référence</li>
                                            <li><code>name</code> : le nom</li>
                                            <li><code>weight</code> : le poids</li>
                                            <li><code>price</code> : le prix (tel qu'il a été saisi sur la fiche du produit)</li>
                                            <li><code>special_price</code> : le prix promotionnel (tel qu'il a été saisi sur la fiche du produit)</li>
                                            <li>…</li>
                                        </ul>
                                    </li>
                                    <li><code>product.attribute.*.value</code> : valeur de l'attribut<br/>Dans le cas des attributs de type liste de sélection, <code>product.attribute.*</code> retourne l'id. Pour obtenir la valeur, il faut utiliser <code>product.attribute.*.value</code></li>
                                    <li><code>product.*</code> : identique à <code>product.attribute.*</code> sauf si la variable est définie (ex: <code>product.category</code>)</li>
                                    <li>Première catégorie du produit :
                                        <ul>
                                            <li><code>product.category</code> : nom de la catégorie</li>
                                            <li><code>product.category.id</code> : id de la catégorie</li>
                                            <li><code>product.category.*</code> : attribut de la catégorie (ex: <code>product.category.is_active</code>)<br/>Attributs intéressants :
                                                <ul>
                                                    <li><code>is_active</code> : catégorie activée ou non</li>
                                                    <li><code>name</code> : nom</li>
                                                    <li>…</li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li>Toutes les catégories du produit (retourne un tableau, <a href="#examples_product_categories">exemples</a>) :
                                        <ul>
                                            <li><code>product.categories</code> : tableau du nom des catégories</li>
                                            <li><code>product.categories.id</code> : tableau de l'id des catégories</li>
                                        </ul>
                                    </li>
                                    <li>Le jeu d'attributs du produit :
                                        <ul>
                                            <li><code>product.attribute_set</code> : nom du jeu d'attributs</li>
                                            <li><code>product.attribute_set.id</code> : id du jeu d'attributs</li>
                                            <li><code>product.attribute_set.*</code> : attribut du jeu d'attributs (ex: <code>product.attribute_set.attribute_set_name</code>)</li>
                                        </ul>
                                    </li>
                                    <li><code>product.stock.*</code> : attribut du stock du produit<br/>Attributs intéressants :
                                        <ul>
                                            <li><code>is_in_stock</code> : disponibilité du produit</li>
                                            <li><code>qty</code> : stock du produit</li>
                                            <li>…</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>

                    <div id="formulas_variables_for_foreach">
                        <h4>Variables utilisables dans les boucles <code>foreach</code></h4>

                        <p>Les variables suivantes peuvent être utilisées dans les <a href="#formulas_foreach">boucles <code>foreach</code></a>.</p>

                        <ul>
                            <li><code>{selection.weight}</code> : poids de la sélection</li>
                            <li><code>{selection.qty}</code> : nombre d'articles dans la sélection</li>
                        </ul>
                        <p>
                            Lorsque la sélection se fait sur le sku, chaque sélection est composée d'un seul article.
                            On peut donc utiliser les <a href="#formulas_variables_for_special_functions">variables article et produit</a>.
                        </p>
                        <ul>
                            <li><code>{item.*}</code> : propriété de l'article</li>
                            <li><code>{product.*}</code> : propriété du produit</li>
                        </ul>
                        <p class="alert alert-info">
                            Les variables article et produit sont identiques aux <a href="#formulas_variables_for_special_functions">variables utilisables dans les fonctions spéciales</a> à la seule différence qu'elles doivent être entourées par les caractères <code>{</code> et <code>}</code>.
                        </p>
                    </div>
                </div>

                <div id="formulas_functions">
                    <h3>Les fonctions</h3>

                    <h4>Les fonctions numériques</h4>
                    <ul>
                        <li><code>abs(x)</code> : valeur absolue</li>
                        <li><code>ceil(x)</code> : arrondi supérieur</li>
                        <li><code>exp(x)</code> : exponentiel</li>
                        <li><code>floor(x)</code> : arrondi inférieur</li>
                        <li><code>log(x)</code> : logarithme népérien</li>
                        <li><code>log(x, base)</code> : logarithme</li>
                        <li><code>max(x, y, …)</code> : maximum, valeurs nulles ignorées</li>
                        <li><code>min(x, y, …)</code> : minimum, valeurs nulles ignorées</li>
                        <li><code>pi()</code> : nombre PI</li>
                        <li><code>pow(x, puissance)</code> : puissance </li>
                        <li><code>rand(min, max)</code> : entier aléatoire</li>
                        <li><code>round(x)</code> : arrondi</li>
                        <li><code>sqrt(x)</code> : racine carrée</li>
                    </ul>

                    <h4>Les fonctions pour manipuler des chaînes de caractères</h4>
                    <ul>
                        <li><code>substr(string, start, length)</code> : retourne un segment de chaîne de caractères.</li>
                    </ul>

                    <h4>Les fonctions pour manipuler des tableaux</h4>
                    <ul>
                        <li><code>in_array(value, array(value1, value2, …))</code> : retourne vrai si la valeur se trouve dans le tableau.</li>
                        <li><code>array_match_any(array(value1, value2, …), array(value1, value2, …))</code> : retourne vrai si au moins une valeur est présente dans les deux tableaux.</li>
                        <li><code>array_match_all(array(value1, value2, …), array(value1, value2, …))</code> : retourne vrai si le contenu des tableaux est identique.</li>
                    </ul>

                    <h4>Fonctions diverses</h4>
                    <ul>
                        <li><code>range(value, min, max, include_min, include_max)</code> : retourne vrai si <code>value</code> est comprise entre <code>min</code> et <code>max</code>. Par défaut, <code>include_min</code> et <code>include_max</code> sont égales à <code>true</code>.</li>
                    </ul>
                </div>

                <div id="formulas_special_functions">
                    <h3>Les fonctions spéciales</h3>

                    <ul>
                        <li><code>{table … in …}</code> : définit des valeurs en fonction de seuils (<a href="#examples_special_table">exemples</a>)</li>
                        <li><code>{switch … in …}</code> : définit une table de correspondance (<a href="#examples_special_switch">exemples</a>)</li>
                    </ul>
                    <p>
                        Le premier paramètre <code>…</code> des fonctions <code>table</code> et <code>switch</code> est la valeur de référence, il peut s'agir soit d'une variable, soit d'une formule.
                    </p>
                    <ul>
                        <li><code>{count items[ where …]}</code> : compte les articles remplissant les conditions (<a href="#examples_special_count">exemples</a>)</li>
                        <li><code>{count distinct …[ where …]}</code> : compte les différentes valeurs d'une propriété pour les articles remplissant les conditions (<a href="#examples_special_count_distinct">exemples</a>)</li>
                        <li><code>{sum …[ where …]}</code> : calcule la somme des valeurs d'une propriété pour les articles remplissant les conditions (<a href="#examples_special_sum">exemples</a>)</li>
                        <li><code>{min …[ where …]}</code> : retourne la valeur minimum d'une propriété pour les articles remplissant les conditions (<a href="#examples_special_min">exemples</a>)</li>
                        <li><code>{max …[ where …]}</code> : retourne la valeur maximum d'une propriété pour les articles remplissant les conditions (<a href="#examples_special_max">exemples</a>)</li>
                    </ul>
                    <p>
                        Le premier paramètre <code>…</code> des fonctions <code>count distinct</code>, <code>sum</code>, <code>min</code> et <code>max</code> doit être une propriété (ex: <code>product.attribute.weight</code>).
                    </p>
                    <p>La condition <code>where</code> est facultative. Si elle est spécifiée, elle le sera sous la forme d'une formule.</p>
                </div>

                <div id="formulas_foreach">
                    <h3>Utilisation des boucles <code>foreach</code></h3>

                    <p>
                        Les boucles <code>foreach</code> permettent d'effectuer un calcul sur des groupes de produits plutôt que de tenir compte de tous les produits du panier.<br/>
                        Le résultat global d'une boucle <code>foreach</code> est la somme des résultats de chaque passage dans la boucle.
                    </p>
                    <p>
                        A l'intérieur d'une boucle <code>foreach</code>, il est possible d'utiliser de <a href="#formulas_variables_for_foreach">nouvelles variables</a>.
                    </p>
                    <p>
                        <a href="#examples_using_foreach">Exemples</a>
                    </p>
                </div>

                <div id="formulas_deprecated_variables">
                    <h3>Les variables dépréciées</h3>
                    
                    <p>Les variables suivantes doivent être remplacées par leur équivalente.</p>
                    
                    <ul>
                        <li><a href="#formulas_variables"><code><span class=strike>{cart.coupon}</span> {cart.coupon_code}</code></a></li>
                        <li><a href="#formulas_variables"><code><span class=strike>{cart.quantity}</span> {cart.qty}</code></a></li>
                        <li><a href="#formulas_variables"><code><span class=strike>{cart.price_excluding_tax}</span> {cart.price-tax+discount}</code></a></li>
                        <li><a href="#formulas_variables"><code><span class=strike>{cart.price_including_tax}</span> {cart.price+tax+discount}</code></a></li>
                        <li><a href="#formulas_variables"><code><span class=strike>{cart.weight.for-charge}</span> {cart.weight_for_charge}</code></a></li>
                        <li><a href="#formulas_variables"><code><span class=strike>{cart.weight.unit}</span> {cart.weight_unit}</code></a></li>
                        <li><a href="#formulas_variables"><code><span class=strike>{customer.group.code}</span> {customer_group.code}</code></a></li>
                        <li><a href="#formulas_variables"><code><span class=strike>{customer.group.id}</span> {customer_group.id}</code></a></li>
                        <li><a href="#formulas_variables"><code><span class=strike>{{customVar code=*}}</span> {customvar.*}</code></a></li>
                        <li><a href="#formulas_variables"><code><span class=strike>{destination.country.code}</span> {shipto.country_id}</code></a></li>
                        <li><a href="#formulas_variables"><code><span class=strike>{destination.country.name}</span> {shipto.country_name}</code></a></li>
                        <li><a href="#formulas_variables"><code><span class=strike>{destination.postcode}</span> {shipto.postcode}</code></a></li>
                        <li><a href="#formulas_variables"><code><span class=strike>{destination.region.code}</span> {shipto.region_code}</code></a></li>
                        <li><a href="#formulas_variables"><code><span class=strike>{free_shipping}</span> {cart.free_shipping}</code></a></li>
                        <li><a href="#formulas_variables"><code><span class=strike>{origin.country.code}</span> {origin.country_id}</code></a></li>
                        <li><a href="#formulas_variables"><code><span class=strike>{origin.country.name}</span> {origin.country_name}</code></a></li>
                        <li><a href="#formulas_variables"><code><span class=strike>{origin.region.code}</span> {origin.region_id}</code></a></li>
                        <li><a href="#formulas_variables_for_foreach"><code><span class=strike>{selection.quantity}</span> {selection.qty}</code></a></li>
                    </ul>
                    <ul>
                        <li><a href="#formulas_variables_for_special_functions"><code><span class=strike>product.quantity</span> item.qty</code></a></li>
                        <li><a href="#formulas_variables_for_special_functions"><code><span class=strike>product.price-tax+discount</span> item.price-tax+discount</code></a></li>
                        <li><a href="#formulas_variables_for_special_functions"><code><span class=strike>product.price-tax-discount</span> item.price-tax-discount</code></a></li>
                        <li><a href="#formulas_variables_for_special_functions"><code><span class=strike>product.price+tax+discount</span> item.price+tax+discount</code></a></li>
                        <li><a href="#formulas_variables_for_special_functions"><code><span class=strike>product.price+tax-discount</span> item.price+tax-discount</code></a></li>
                        <li><a href="#formulas_variables_for_special_functions"><code><span class=strike>product.option.*</span> item.option.*</code></a></li>
                        <li><a href="#formulas_variables_for_special_functions"><code><span class=strike>product.option.*</span> item.option.*</code></a></li>
                    </ul>
                </div>
            </div>

            <div id="more">
                <h2>Divers</h2>
                
                <div id="more_tracking_url">
                    <h3>L'URL de suivi <code>tracking_url</code></h3>

                    <p class="alert alert-danger">
                        L'utilisation de la propriété <code>tracking_url</code> est réservée aux utilisateurs expérimentés. Si vous ne comprenez pas les indications ci-dessous, il est préférable que vous évitiez d'utiliser cette fonctionnalité.
                    </p>
                    <p>
                        La propriété <code>tracking_url</code> permet de surcharger le champ "URL de suivi" d'un mode de livraison Owebia-Shipping et ainsi de spécifier une URL de suivi <strong>par méthode de livraison</strong> plutôt qu'une pour tout le mode de livraison.
                    </p>
                    <p>
                        Pour insérer automatiquement le numéro de colis dans l'URL de suivi, vous devez utiliser <code>{tracking_number}</code>.
                    </p>

                    <div class="json">{
                    "__auto__":{"label":"Exemple avec URL de suivi pour le transporteur Colissimo","fees":10,"tracking_url":"http://www.coliposte.net/particulier/suivi_particulier.jsp?colispart={tracking_number}"}
                    }</div>

                    <p>
                        Magento ne gère pas les liens de tracking mais un statut de tracking. L'extension Owebia-Shipping fournit un lien HTML à la place du statut, lien qui permet d'aller sur le site du transporteur et de suivre l'avancement de la livraison du colis.
                    </p>
                    <p>
                        Lorsque l'URL de suivi est construite par l'extension, la seule information disponible est le numéro de colis et on n'a nul part accès à la méthode de livraison sélectionnée. Afin de pouvoir retrouver l'url de suivi dans la configuration, il faut spécifier la méthode de livraison dans le numéro de tracking, par exemple : <code>colissimo:8Lxxxxxxxxxxx</code> où <code>colissimo</code> est le code de la méthode de livraison sélectionnée.<br/>
                        Si aucun code n'est spécifié (si vous saisissez uniquement le numéro de tracking), l'url utilisée sera celle globale au mode de livraison.
                    </p>
                    <p class="alert alert-danger">
                        Pour répondre à une question récurrente, Magento affiche le statut de livraison depuis le back office ou le front office. Si vous souhaitez insérer l'URL de suivi dans les mails d'expédition, <strong>vous devrez développer vous même</strong> la récupération de l'URL de suivi et son insertion dans le mail, en effet, l'extension Owebia-Shipping se contente de fournir des modes de livraison paramétrables sans apporter de grande modification au coeur de Magento afin de réduire les problèmes d'incompatibilité et de mise à jour.
                    </p>
                    <p class="alert alert-danger">
                        Si vous obtenez un popup vide lorsque vous cliquez sur le lien de suivi, votre problème est très certainement lié au fait que vous n'avez pas spécifié le code de la méthode de livraison dans le numéro de suivi (voir indications plus haut) et que votre champ global "URL de suivi" est vide.
                    </p>
                    <p class="alert alert-danger">Il n'est actuellement pas prévu de modifier les fonctionnalitées de l'extension liées à l'URL de suivi.</p>
                </div>
            </div>

            <div id="changelog">
                <h2>Changelog</h2>

                <pre class=changelog>
[2.5.23 - August 18, 2016]
Fix special functions call issue: missing opening parenthesis

[2.5.22 - July 18, 2016]
Add composer.json and modman files

[2.5.21 - May 9, 2016]
Fix replacement of special functions, thanks to Sébastien L.

[2.5.20 - 25 avril 2016]
Fix code indentation
Fix version number
Add readme file in package

[2.5.19 - 09 novembre 2015]
Note: the extension is not affected by the patch SUPEE-6788 since it uses the new admin url routing syntax for 3 years (version 2.4.8.0)
Fix bug: deactivation of auto-escaping by default since it can cause some bugs (ex: impossible to use {address_filter.EU-27} in shipto)
Fix bug: fix auto-escaping of properties like {{shipto.country_name}}
Fix bug: variable replacements in labels (variables {cart.price-tax-discount}, {cart.price-tax+discount}, {cart.price+tax-discount} and {cart.price+tax+discount})
Fix bug: use items and not quote to retrieve values {cart.price-tax-discount}, {cart.price-tax+discount}, {cart.price+tax-discount} and {cart.price+tax+discount} (quote totals are not available at this time, calculating them causes duplications of addresses and a false grand_total value)
Fix bug: retrieve customer in backoffice order
Fix unicode accented chars in json_encode for PHP &lt; 5.4
Fix bug: usage of regular expressions inside {count ...}, {sum ...}, {min ...} and {max ...}
Allow usage of php functions date and strtotime (ex: "label": "'Your package will be delivered between ' . date('d/m', strtotime('+5 days')) . ' and ' . date('d/m Y', strtotime('+7 days'))",

[2.5.18 - 24 juillet 2014]
Pas de modification, nouvelle version pour Magento Connect

[2.5.17 - 24 juillet 2014]
Correction d'un bug d'affichage des totaux dans le panier suite au correctif 2.5.16 : annulation de la modification faite dans la version 2.5.14 (récupération de la session avec Mage::getModel('checkout/session') et non avec Mage::getSingleton('checkout/session'), avec getSingleton, $session->getQuote() ne contient pas les totaux calculés et si on appelle $quote->collectTotals(), les totaux sont doublés)

[2.5.16 - 24 juillet 2014]
Correction d'un bug dans le montant du panier suite à la modification de la récupération de la session dans la version 2.5.14 : appel de $quote->collectTotals();

[2.5.15 - 07 juin 2014]
Remplacement de static:: par self:: pour une rétro-compatibilité avec PHP < 5.3

[2.5.14 - 26 mai 2014]
Correction des retours lignes dans 3 fichiers : CR => CRLF (merci à Christophe S.)
Correction d'un bug avec l'utilisation des expressions régulières et des caractères joker dans le filtrage des adresses (merci à Alexis A., Morgan R., Maxime L.)
Correction d'un bug dans le calcul de la valeur {cart.price+tax+discount}
Correction d'un bug dans la récupération de la session (merci à Gabriel F.)
Support des nombres au format 2.04e2 avec le e en minuscule (merci à Morgan R.)
Ajout de la possibilité d'avoir des espaces, des virgules et des tirets dans le nom des codes région en entourant les valeurs par des guillemets (ne pas oublier de les échapper si nécessaire)

[2.5.13 - 5 novembre 2013]
Correction d'un bug avec l'auto-escaping des chaînes de caractères dans les tableaux (merci à Sylvain P.)
Correction d'un bug dans le calcul des variables {car.price+tax+discount} et {cart.price+tax-discount} lorsque le panier contenait des produits packagés (merci à Nematis)
Suppression des caractères &amp;gt; et &amp;lt; restés dans les exemples de configuration JSON dans la documentation
Correction d'un bug avec {cart.free_shipping}
Correction d'un bug dans Owebia_Shipping2_Model_Os2_Data_Cart qui posait problème lorsque les classes Mage_Sales_Model_Quote_Address_Item et Mage_Sales_Model_Quote_Item étaient redéfinies (merci à Franck T.)
Suppression de la configuration Colissimo dans le 1er mode de livraison : la configuration est téléchargeable sur le site owebia.com
Modification de l'origine des montants du panier (merci à carouze et Mathieu, voir http://www.magentocommerce.com/boards/viewthread/274340/P15/#t382192)
Ajout de nouvelles variables {quote.*}
Ajout d'une option pour réaliser l'auto-échappement systématique des variables

[2.5.12 - 21 février 2013]
Suppression des tarifs Chronopost et Export 3J périmés (modification 2.5.10 beta non effective)
Passage en mode Stable
Rappel : depuis la version 2.5.01 beta, la syntaxe de la configuration a changée pour devenir compatible à 100% JSON. Cela permet de meilleures performances (à condition que le JSON soit correct) car le travail de parsing de la configuration est réalisé par les fonctions natives ou celles du framework Zend. Cela permet également à d'autres scripts de venir créer des configurations car le format JSON est un format d'échange standard.

[2.5.11 beta - 10 janvier 2013]
Compatibilité avec PHP &lt; 5.3.0 (json_last_error)

[2.5.10 beta - 09 janvier 2013]
Suppression des tarifs Chronopost et Export 3J périmés
Ajout d'un lien &quot;Télécharger des modèles de configuration&quot; sous les champs &quot;Configuration&quot;
Correction d'un problème avec les customvar : récupération de la valeur store plutôt que la valeur par défaut
Ajout de l'option case insensitive dans les expressions régulières des adresses
Correction d'une variable indéfinie $get_by_id dans Owebia_Shipping2_Model_Os2_Data_AbstractWithAttributes
Modification du traitement des produits bundle (correction de la valeur de {cart.qty}, possibilité de traiter soit le produit bundle, soit les produits enfants)

[2.5.09 beta - 07 janvier 2013]
Interception des erreurs résultant de l'utilisation de json_decode()
Utilisation de la propriété &quot;code&quot; pour définir l'ID du nouvel object lors de la correction automatique de la configuration (sinon deux passes étaient nécessaires)
Attribution d'un ID prévisible (incrémental) pour les blocks meta d'autocorrection afin de pouvoir les éditer
Échappement des backslashes dans la fonction jsonEncode
Correction d'un bug avec l'utilisation des sum, min, max et count
Correction d'un bug d'affichage du champ d'édition lorsque plusieurs pages étaient ouvertes dans l'éditeur
Correction d'un problème rencontré lorsque la compression des javascript et css était activée
Mise à jour des tarifs Colissimo (1/03/2012)

[2.5.08 beta - 20 décembre 2012]
Correction d'un problème lié à un bug d'IE : la propriété CSS white-space: nowrap ne fonctionne pas sous IE (utilisée sur le textarea source de l'éditeur)
Correction d'un bug lorsque foreach est utilisé, les items du cart étaient écrasés, ce qui pouvait poser problème pour la suite des calculs (merci à David G.)

[2.5.07 beta - 14 décembre 2012]
Correction d'un problème d'incompatibilité avec la compilation de Magento

[2.5.06 beta - 10 décembre 2012]
Correction d'un bug dans OwebiaShippingHelper-&gt;_processProduct lorsqu'il n'y a pas de produit dans le panier
Petites corrections de la documentation
Traduction de la documentation en anglais

[2.5.05 beta - 27 novembre 2012]
Ajout de la variable {date.weekday}
Correction d'un bug dans OwebiaShippingHelper-&gt;processRow (merci à Rod)

[2.5.04 beta - 27 novembre 2012]
Correction du code PHP pour supprimer des erreurs E_STRICT (merci à Cyril R.)
Suppression du répertoire &quot;development-bundle&quot; de jQuery UI (-1.43 Mo)

[2.5.03 beta - 22 novembre 2012]
Rétrocompatibilité du code avec la version 5.2 de PHP

[2.5.02 beta - 22 novembre 2012]
Correction d'un problème de packaging
Réorganisation de la documentation
Ajout du numéro de version dans l'onglet &quot;Modes de livraison&quot;
Mise à jour de la syntaxe de la configuration par défaut

[2.5.01 beta - 21 novembre 2012]
Modification de la syntaxe de la configuration pour la rendre 100% compatible JSON
Refonte complète de l'éditeur
Suppression de la compatibilité avec les propriétés dépréciées suivantes :
    'fees_table', 'fees_formula', 'fixed_fees', 'reference_value', 'prices_range', 'weights_range', 'product_properties',
    'free_shipping__fees_table', 'free_shipping__fees_formula', 'free_shipping__fixed_fees', 'free_shipping__label',
Suppression de la compatibilité avec la désactivation d'une méthode de livraison à l'aide du caractère #
Suppression de la compatibilité avec les mots réservés en majuscule : TABLE, SUM, COUNT, DISTINCT et IN
Ajout des fonctions array_match_any et array_match_all
Correction de product.categories et product.categories.id qui ne marchait plus depuis la version 2.4.8
Mise à jour de la documentation en Français

[2.4.8 beta - 28 août 2012]
Modification du controller utilisé pour l'éditeur afin que cela fonctionne toujours lorsque l'url du backoffice de celle du frontoffice ne sont pas sur le même sous-domaine (ex: admin.example.org et www.example.org) (merci à Brice C.)
Restructuration complète des variables afin d'optimiser le chargement des données (uniquement si elles sont utilisées)
Ajout de nouvelles variables {customer_group.*}, {customer.*}, {request.*}, {item.*}, {billto.*}
Renommage de certaines variables ({destination.*} =&gt; {shipto.*}, {free_shipping} =&gt; {cart.free_shipping}, {cart.quantity} =&gt; {cart.qty}, ...)
Ajout de l'option &quot;auto correction&quot; qui permet de désactiver les corrections automatiques de compatibilité de la configuration afin d'avoir de meilleures performances
Ajout de la fonction spéciale range()
Renommage de l'onglet &quot;Owebia&quot; en &quot;Owebia Shipping 2&quot;
Gestion des Bundle Product et des Configurable Product (possibilité de choisir où récupérer les données depuis l'onglet &quot;Owebia Shipping 2&quot;)
Mise à jour de la documentation

[2.4.7 - 20 mars 2012]
Correction du code PHP pour supprimer des erreurs E_STRICT

[2.4.6 - 19 janvier 2012]
Correction d'un bug dans l'utilisation de la fonction {table ... in ...} : lorsque la variable de référence est indéfinie, le résultat était invalide (valeur précédente de la variable $replacement)
Correction d'un problème avec les produits packagés (bundle product) : les produits 'bundle' et les produits 'simple' étaient tous deux récupérés ce qui faussait les résultats
Support des sets d'attributs
    product.attribute_set dans les conditions de boucle foreach
    {product.attribute_set} et {product.attribute_set.id} comme variables dans les boucles foreach
    product.attribute_set, product.attribute_set.id dans les conditions des opérations sum, count, min et max
Optimisation du chargement de certaines valeurs (catégories, attribute set, ...)
Correction d'un problème avec les castings successifs (string), (float) qui posent problème lorsque la locale utilise la virgule comme séparateur de décimales

[2.4.5 - 12 janvier 2012]
Ajout de la fonction switch
Ajout d'une syntaxe pour auto-échapper les chaînes de caractères (ex: {{cart.coupon}} donnera null ou 'test' en fonction de la valeur de la variable)
Dans le cas d'un produit configurable avec option personnalisable, on récupère les options du produit parent et pas celles du produit enfant
Mise à jour de la documentation

[2.4.4 - 30 novembre 2011]
Correction d'un bug avec l'utilisation de product.category.id
Ajout des valeurs memory_limit et memory_usage dans le debug

[2.4.3 - 11 octobre 2011]
Support de la variable {cart.coupon} depuis le backoffice de Magento (merci à mfoillard, CF: http://www.magentocommerce.com/boards/viewthread/262907/)
Correction d'un bug dans les opérations sum, count, min et max ($properties = array(); écrasait plusieurs fois les valeurs précédentes)

[2.4.2 - 07 octobre 2011]
Support des nombres décimaux représentés sous la forme 5.3290705182E-15
Modification de la licence du code source (MIT au lieu de OSL 3.0)
Mise à jour des mentions de copyright et de licence
Nettoyage du code source (suppression de lignes de code en commentaire)
Initialisation des formules sum et count à 0 au lieu de null (pour éviter les erreurs de formule si aucun produit ne correpond)
Ajout des alias &quot;a&quot; et &quot;attr&quot; pour &quot;attribute&quot;, &quot;o&quot; et &quot;opt&quot; pour &quot;option&quot;, &quot;p&quot; pour &quot;product&quot;, &quot;c&quot; pour &quot;cart&quot;, &quot;s&quot; pour &quot;selection&quot;
Correction de la récupération des variables personnalisées : getValue('text') au lieu de getValue('plain')
Support des catégories
    product.categories dans les conditions de boucle foreach
    {product.category} et {product.category.id} comme variables dans les boucles foreach
    product.category, product.category.id, product.categories, product.categories.id dans les conditions des opérations sum, count, min et max
Amélioration du debug

[2.4.1 - 24 août 2011]
Modification légère du code php pour éviter un plantage avec certaines versions d'eAccelerator (cache php)
        $row = null;
        $this-&gt;addMessage('info',$row,null,'Ignored lines %s','&lt;div class=&quot;code&quot;&gt;'.trim($config_string).'&lt;/div&gt;');
    au lieu de ;
        $this-&gt;addMessage('info',$row=null,null,'Ignored lines %s','&lt;div class=&quot;code&quot;&gt;'.trim($config_string).'&lt;/div&gt;');
    (cf http://www.magentocommerce.com/boards/viewthread/233202/)
Ajout des variables de debug &quot;info.server.os&quot; et &quot;info.server.software&quot;
Ajout de la possibilité de récupérer la valeur minimum ou maximum de la quantité (ex: &quot;{max product.quantity}&quot;)

[2.4.0 - 27 juin 2011]
Correction d'un bug lorsque plusieurs produits identiques avec des options différentes sont présents dans le panier (la valeur de l'option était toujours égale à celle du premier produit)
Ajout de la possibilité d'utiliser les expressions régulières dans les champs &quot;destination&quot; et &quot;origin&quot;
Ajout de la variable {car.weight.for-charge}
Mise à jour de la documentation en français
Mise à jour de l'éditeur
Correction d'un bug de l'éditeur lorsqu'on éditait une destination puis qu'on cliquait sur Annuler

[2.3.11 - 28 avril 2011]
Correction d'un problème d'encodage/décodage entre le javascript et le php via ajax (les signes &quot;+&quot; disparaissaient)
Surcharge du fichier Mage/Checkout/controllers/CartController.php pour corriger un problème avec Magento : les champs Mage_Sales_Quote_Item-&gt;_data['tax_amount'] n'étaient pas mis à jour correctement, ce qui créait un décalage et faussait la variable {cart.price+tax+discount}

[2.3.10 - 12 avril 2011]
Correction d'un problème dans AjaxController.php : passage direct d'un tableau par référence, il faut d'abord créer le tableau dans une variable puis passer la variable par référence
Ajout de la variable {cart.coupon}
Ajout des variables {cart.price-tax+discount}, {cart.price-tax-discount}, {cart.price+tax+discount}, {cart.price+tax-discount} qui permettent d'avoir le montant que l'on désire, avec ou sans prise en compte des taxes et des remises
Gestion semblable pour les attributs des produits : product.attribute.price-tax+discount utilisable dans une structure {sum} par exemple
Ajout de la possibilité de récupérer la valeur minimum ou maximum d'un attribut ou d'une option (utilisation identique à sum)

[2.3.9 - 20 janvier 2011]
Correction d'un problème avec le fichier adminhtml.xml (il y avait un commentaire avant l'en-tête XML)

[2.3.8 - 14 janvier 2011]
Correction d'un bug avec la propriété &quot;customer_groups&quot; lorsqu'on utilisait les id's (is_int remplacé par ctype_digit)
Modifications des champs de configuration :
- Le champ &quot;debug&quot; devient de type Oui/Non
- Le champ &quot;auto-compression&quot; devient &quot;compression&quot; de type Oui/Non
Implémentation d'une compression efficace :
- La configuration est compressée à l'aide de la fonction gzcompress() puis encodée en base 64 afin d'être facilement placée dans un champ textarea
- La longueur de configuration peut être divisée par 4 grâce à la compression
- La compression peut être utile sur certaines configurations où la longueur des champs est limitée
Amélioration de l'éditeur :
- Récupération des groupes utilisateurs de Magento et création d'un bouton pour chacun d'eux
- Ajout d'un bouton &quot;Aide&quot; (qui ouvre l'aide de l'éditeur) à droite du bouton &quot;Ouvrir l'éditeur&quot;
- Centralisation du changelog dans un fichier app/code/community/Owebia/Shipping2/changelog plutôt que dans les fichiers de langue
- L'éditeur compresse/décompresse la configuration (si la compression est activée)
Amélioration du debug
- Ajout des versions de PHP et de Magento
- Correction du chemin du fichier OwebiaShippingHelper.php
- Affichage du debug par la commande Mage::getSingleton('core/session')-&gt;addNotice() afin d'avoir un affichage plus propre (à l'intérieur des balises html)
- Affichage du debug seulement sur la page checkout/cart/index
Création d'un fichier app/code/community/Owebia/Shipping2/etc/adminhtml.xml (pour résoudre les problèmes d'accès à la section de configuration Owebia)
Mise à jour des tarifs par défaut avec les tarifs Colissimo Particuliers 2010 et Chronopost web 2010

[2.3.7 - 11 janvier 2011]
Modification de la récupération du timestamp courant en tenant compte du fuseau horaire sélectionné
Modification du CSS de l'éditeur pour palier à une modification du CSS du backoffice (sur les balises legend)
Ajout de contrôles isset dans le fichier app/code/community/Owebia/Shipping2/controllersAjaxController.php (merci à Damien C.)
Échappement des guillemets doubles dans la méthode _getConfig() dans le fichier js/owebia/shipping2/os2editor.js (merci à Damien C.)
Ajout de la méthode getRates() dans la classe Owebia_Shipping2_Model_Carrier_AbstractOwebiaShipping qui permet de récupérer les frais de port en injectant les données que l'on souhaite en paramètre
Réécriture de la méthode collectRates()

[2.3.6 - 23 novembre 2010]
Ajout d'un fichier app/etc/modules/Owebia_Shipping_2.xml vide pour écraser celui des versions précédentes à la 2.3.0 afin d'éviter une cohabitation de deux versions
Amélioration du traitement des commentaires avec l'éditeur (gestion des caractères #)

[2.3.5 - 08 novembre 2010]
Correction d'un problème chez les utilisateurs ayant une version de PHP antérieure à 5.3.0

[2.3.4 - 06 novembre 2010]
Correction d'un bug introduit dans la version 2.3.2 lors de l'utilisation des attributs et options avec les fonctions sum, count et count distinct

[2.3.3 - 05 novembre 2010]
Possibilité de faire des copie de propriétés de façon récursive avec contrôle de boucle infinie

[2.3.2 - 05 novembre 2010]
Amélioration de l'éditeur :
- Ajout de l'aide en langue anglais
- Ajout d'informations dans l'aide
- Ajout des messages d'erreur de la configuration, avec possibilité de correction rapide
- Ajout de champs pour les lignes ignorées : on peut ainsi les modifier et appliquer les modifications
Ajout de la possibilité d'accéder aux informations sur le stock d'un produit grâce aux variables {product.stock.is_in_stock} et {product.stock.quantity}
Suppression de l'affichage du message d'erreur &quot;&quot;Correspondance non trouvée&quot;&quot;
Correction d'un bug avec les groupes utilisateur ($id==null retournait true lorsque $id était égal à 0)
Correction d'une erreur de récupération de l'unité de poids
Améliorations diverses

[2.3.1 - 29 octobre 2010]
Correction d'un bug dans le fichier AjaxController : une variable n'était pas définie, ce qui générait une erreur avec certaines configurations PHP

[2.3.0 - 28 octobre 2010]
Correction d'un bug avec le caractère * dans les champs &quot;&quot;destination&quot;&quot; et &quot;&quot;origin&quot;&quot; comme jocker
Ajout d'un éditeur pour faciliter la modification des configurations Owebia Shipping
L'éditeur contient également une aide
Déplacement de certains fichiers pour mieux correspondre à la structure de Magento

[2.2.8 - 20 octobre 2010]
Correction d'une erreur dans l'include d'OwebiaShippingHelper lorsqu'on utilise le Compiler
Correction d'un bug de calcul du prix TTC dans certains cas ('row_total_with_discount' est égal à 0)
Ajout de la possibilité d'utiliser le caractère * dans les champs &quot;&quot;destination&quot;&quot; et &quot;&quot;origin&quot;&quot; comme jocker (par exemple &quot;&quot;FR(25*)&quot;&quot; retournera vrai pour tous les codes postaux du département du Doubs)
Ajout d'un bouton pour fermer la console de debug
Ajout d'informations dans le debug (tests sur la destination et l'origine, liste des variables passées en paramètre)
Affichage du debug uniquement sur la page panier (pas sur les pages en ajax)
Récupération du bon customer group lors d'une commande créée depuis le backoffice de Magento

[2.2.7 - 27 août 2010]
Possibilité d'utiliser les variables personnalisées (custom variables) de Magento grâce à la syntaxe {customvar.my_var} ou à la syntaxe standard {{customVar code=my_var}}

[2.2.6 - 25 août 2010]
Correction d'un bug avec la fonction getRowProperty() : utilisation de preg_match_all() à la place de while(preg_match()) et utilisation de continue à la place de break

[2.2.5 - 22 août 2010]
Correction d'un bug avec les propriétés de type booléenne spécifiées sans les guillemets (comme la propriété enabled)
Correction d'un bug avec la propriété customer_groups

[2.2.4 - 10 août 2010]
Utilisation de Mage::getModel('directory/country')-&gt;load($country_code)-&gt;getName() à la place de Mage::getModel('core/locale')-&gt;getLocale()-&gt;getTranslationList('territory',null,2) pour récupérer le nom d'un pays dans la langue courante (la première solution semble retourner le nom du pays dans la langue principale de la boutique), merci à coolshop pour la solution proposée
Remplacement de la valeur de configuration &quot;&quot;Afficher quand indisponible&quot;&quot; par la valeur &quot;&quot;Debug&quot;&quot; car la solution précédente posait des problèmes avec Magento 1.4.0
Amélioration de la clarté du debug (utilisation de couleurs et d'indentations)
Correction de bugs légers
Mise à jour de la syntaxe de la configuration proposée par défaut

[2.2.3 - 29 juillet 2010]
Correction d'un bug avec le traitement de formules dont le résultat est false

[2.2.2 - 29 juillet 2010]
Amélioration du système de cache des formules

[2.2.1 - 27 juillet 2010]
Correction de petits bugs

[2.2.0 - 22 juillet 2010]
Possibilité de compression/décompression de la configuration
Modification de certaines propriétés ({weight} =&gt; {cart.weight}, {price_excluding_tax} =&gt; {cart.price_excluding_tax}, {price_including_tax} =&gt; {cart.price_including_tax}, {products_quantity} =&gt; {cart.quantity},{contry} =&gt; {destination.country.name})
Syntaxe légèrement modifié pour {product.attribute.xxx} et {product.option.xxx} (pas de s)
Ajout de nouvelles propriétés utilisables dans le foreach : {selection.weight}, {selection.quantity}, {product.weight}, {product.quantity}
Possibilité d'utiliser {product.attribute.xxx} et {product.option.xxx} dans le foreach

[2.1.9 - 20 juillet 2010]
Évaluation des formules contenues dans les propriétés &quot;&quot;label&quot;&quot; et &quot;&quot;description&quot;&quot;

[2.1.8 - 20 juillet 2010]
Correction d'une erreur dans le foreach (l'attribut était toujours &quot;&quot;name&quot;&quot;)

[2.1.7 - 19 juillet 2010]
Ajout de la syntaxe foreach product.attribute.xxx

[2.1.6 - 28 décembre 2009]
Correction d'une erreur dans le nom d'une variable qui entrainait un plantage dans certaines situations

[2.1.5 - 28 décembre 2009]
Modification de la syntaxe des tables (pour offrir plus de souplesse)

[2.1.4 - 24 décembre 2009]
Modification de la syntaxe d'utilisation des propriétés des produits (pour offrir beaucoup plus de souplesse)
Possibilité de filtrer les produits dont on veut utiliser les propriétés.
Ajout de 'COUNT DISTINCT'

[2.1.3 - 17 décembre 2009]
Correction du calcul du nombre de produits dont les propriétés correspondent &quot;&quot;{count ...&quot;&quot; : prise en compte de la quantité
Simplification de la syntaxe de copie de propriété

[2.1.2 - 27 novembre 2009]
Correction d'un problème de priorité entre l'opérateur &quot;&quot;=&quot;&quot; et l'opérateur &quot;&quot;and&quot;&quot; dans l'évaluation des formules : ajout de parenthèses autour de la formule

[2.1.1 - 26 novembre 2009]
Suppression de la propriété 'product_properties' qui doit être utilisée dans la propriété 'conditions'
Améliorations diverses

[2.1.0 - 24 novembre 2009]
Regroupement des propriétés 'fees_table', 'fees_formula' et 'fixed_fees' dans une unique propriété 'fees'
Regroupement des propriétés 'prices_range' et 'weights_range' dans une unique propriété 'conditions'
Suppression de la propriété 'reference_value'
Suppression des propriétés 'free_shipping__fees_table', 'free_shipping__fees_formula' et 'free_shipping__fixed_fees' (utiliser '{free_shipping}' dans la propriété 'conditions' à la place)
Ajout d'un analyseur de syntaxe de la configuration pour indiquer l'utilisation de propriétés non reconnues ou de propriétés obsolètes, les valeurs non reconnues, les virgules manquantes en fin de ligne, les doublons des propriétés 'code'
Utilisation des valeurs des propriétés obsolètes dans leur nouvel équivalent
Possibilité de copier une propriété avec la syntaxe &quot;&quot;{copy 'colissimo'.'fees'}&quot;&quot;
Nouvelle syntaxe pour les tables (ancienne propriété 'fees_table') : &quot;&quot;{table 'weight' 1.0:2.50, 2.0:3.00}&quot;&quot; qui peuvent désormais être intégrées dans des formules
Séparation des méthodes publique, privées génériques (préfixe '_'), privées spécifiques à Magento (préfixe '__') pour faciliter le portage du module vers un autre système de boutique en ligne que Magento

[2.0.12 - 19 novembre 2009]
Amélioration de la transmission des variables entre les méthodes de la classe

[2.0.11 - 19 novembre 2009]
Correction du filtrage en fonction des options et des attributs des produits en présence de produits configurables

[2.0.10 - 13 novembre 2009]
Amélioration du filtrage en fonction des options et des attributs des produits
Correction du filtrage en fonction des options des produits

[2.0.9 - 12 novembre 2009]
Correction du filtrage en fonction des options des produits

[2.0.8 - 12 novembre 2009]
Possibilité de filtrer en fonction des options des produits

[2.0.7 - 04 novembre 2009]
Possibilité de filtrer en fonction de l'origine de livraison
Possibilité de filtrer en fonction des attributs de produits
Possibilité de spécifier un code postal dans le filtrage de la destination
Compatibilité avec Magento 1.4.* : utilisation de la fonction getTranslationList au lieu de getCountryTranslationList qui est dépréciée

[2.0.6 - 02 octobre 2009]
Possibilité de spécifier des groupes de clients

[2.0.5 - 18 août 2009]
Ajout de la possibilité de spécifier dans la destination le monde entier sauf certains pays
Correction d'un problème de parsing de la destination lorsqu'il n'y avait qu'un seul code région entre parenthèses
Possibilité d'avoir des codes région comprenant des espaces

[2.0.4 - 28 juillet 2009]
Suppression des options &quot;&quot;Unité de poids&quot;&quot; et &quot;&quot;Utiliser le montant TTC&quot;&quot; de chaque mode de livraison
Possibilité d'inclure ou d'exclure les valeurs limites dans les champs 'prices_range', 'weights_range' et 'fees_table' grâce aux caractères '[' et ']'
Possibilité de spécifier dans les champs 'prices_range' et 'fees_table' si on utilise le montant HT ou TTC
Ajout du champ 'enabled' et suppression de la possibilité de désactiver un bloc de configuration avec le caractère '#'
Modification du message d'erreur par défaut
Ajout d'un message d'erreur en cas d'erreur d'interprétation d'une formule de calcul de frais

[2.0.3 - 27 juillet 2009]
Correction d'une erreur dans l'interprétation des formules avec des fonctions à arguments multiples (min, max, rand)

[2.0.2 - 27 juin 2009]
Correction d'une erreur d'expression régulière

[2.0.1 - 25 juin 2009]
Uniformisation du nom des variables dans les valeurs de référence : 'price_excluding_tax' et 'price_including_tax' à la place de la valeur 'price'
Correction d'un problème de Magento qui ne semble pas retourner la bonne valeur lors de l'appel à la méthode $request-&gt;getFreeShipping()
Ajout du champ 'description' qui permet d'ajouter une description à une méthode de livraison qui peut être récupérée grâce à la méthode $_rate-&gt;getMethodDescription()
Corrections de bugs

[2.0 - 3 avril 2009]
Création de la version 2.0 du module Owebia Shipping qui n'est plus compatible avec les anciennes versions

                </pre>
            </div>

            <div id="index">
                <h2>Index</h2>
                <div class="panel">
                    <div class="row">
                        <div class="col-lg-6">
                            <h3>A</h3>
                            <ul>
                                <li><code>about</code> : <a href="#property_about">propriété</a></li>
                                <li>activation : voir <code>enabled</code></li>
                                <li>adresse d'envoi : voir <code>origin</code></li>
                                <li>adresse de facturation : voir <code>billto</code></li>
                                <li>adresse de livraison : voir <code>shipto</code></li>
                                <li><code>address_filter</code> : <a href="#address_filter">raccourci</a>, <a href="#examples_using_address_filters_shortcuts">exemples</a></li>
                                <li>attribut produit : voir <code>product.attribute.*</code></li>
                            </ul>

                            <h3>B</h3>
                            <ul>
                                <li><code>billto</code> :
                                    <ul>
                                        <li><a href="#property_billto">propriété</a></li>
                                        <li><a href="#formulas_variables_billto">variables</a></li>
                                    </ul>
                                </li>
                                <li>bon de commande : voir <code>quote</code></li>
                            </ul>

                            <h3>C</h3>
                            <ul>
                                <li><code>cart</code> : <a href="#formulas_variables_cart">variables</a></li>
                                <li>commentaire : voir <code>about</code></li>
                                <li><code>conditions</code> : <a href="#property_conditions">propriété</a></li>
                                <li><code>count</code> : <a href="#formulas_special_functions">fonction spéciale</a></li>
                                <li><code>count distinct</code> : <a href="#formulas_special_functions">fonction spéciale</a></li>
                                <li><code>customer</code> : <a href="#formulas_variables_customer">variables</a></li>
                                <li><code>customer_group</code> : <a href="#formulas_variables_customer_group">variables</a></li>
                                <li><code>customer_groups</code> : <a href="#property_customer_groups">propriété</a></li>
                                <li><code>customvar</code> : <a href="#formulas_variables_customvar">variables</a></li>
                            </ul>

                            <h3>D</h3>
                            <ul>
                                <li><code>data</code> : <a href="#definitions_element">type d'élément</a>, <a href="#examples_data">exemples</a></li>
                                <li><code>date</code> : <a href="#formulas_variables_date">variables</a></li>
                                <li>désactivation : voir <code>enabled</code></li>
                                <li><code>description</code> : <a href="#property_description">propriété</a></li>
                                <li>destination : voir <code>shipto</code></li>
                                <li>DOM/TOM : <a href="#examples_excluding_domtom_postcode">exclusion des codes postaux</a></li>
                            </ul>

                            <h3>E</h3>
                            <ul>
                                <li>élément : <a href="#definitions_element">définition</a></li>
                                <li><code>enabled</code> : <a href="#property_enabled">propriété</a></li>
                                <li>expression régulière : voir la propriété <code>shipto</code></li>
                            </ul>

                            <h3>F</h3>
                            <ul>
                                <li><code>fees</code> : <a href="#property_fees">propriété</a></li>
                                <li><a href="#formulas_functions">Fonctions</a></li>
                                <li><code>foreach</code> : <a href="#formulas_foreach">boucle</a>, <a href="#examples_using_foreach">exemples</a></li>
                                <li><a href="#formulas">Formules</a></li>
                                <li>frais de port : voir <code>fees</code></li>
                            </ul>

                            <h3>G</h3>
                            <ul>
                                <li>gratuit : voir "port offert"</li>
                                <li>groupes client : voir <code>customer_groups</code></li>
                            </ul>

                            <h3>I</h3>
                            <ul>
                                <li>identifiant unique : <a href="#definitions_unique_id">définition</a></li>
                                <li><code>item</code> : <a href="#formulas_variables_item">variables</a></li>
                                <li><code>item.option.*</code> : <a href="#formulas_variables_item">variables</a></li>
                            </ul>
                        </div>
                        <div class="col-lg-6">
                            <h3>L</h3>
                            <ul>
                                <li><code>label</code> : <a href="#property_label">propriété</a></li>
                            </ul>

                            <h3>M</h3>
                            <ul>
                                <li><code>max</code> :
                                    <ul>
                                        <li><a href="#formulas_functions">fonction</a></li>
                                        <li><a href="#formulas_special_functions">fonction spéciale</a>, <a href="#examples_special_max">exemples</a></li>
                                    </ul>
                                </li>
                                <li><code>meta</code> : <a href="#definitions_element">type d'élément</a>, <a href="#examples_meta">exemples</a></li>
                                <li><code>method</code> : <a href="#definitions_element">type d'élément</a></li>
                                <li><code>min</code> :
                                    <ul>
                                        <li><a href="#formulas_functions">fonction</a></li>
                                        <li><a href="#formulas_special_functions">fonction spéciale</a>, <a href="#examples_special_min">exemples</a></li>
                                    </ul>
                                </li>
                            </ul>

                            <h3>O</h3>
                            <ul>
                                <li>offert : voir "port offert"</li>
                                <li>option produit : voir <code>item.option.*</code></li>
                                <li><code>origin</code> :
                                    <ul>
                                        <li><a href="#property_origin">propriété</a></li>
                                        <li><a href="#formulas_variables_origin">variables</a></li>
                                    </ul>
                                </li>
                            </ul>

                            <h3>P</h3>
                            <ul>
                                <li>panier : voir <code>cart</code></li>
                                <li>port offert : <a href="#examples_simple">exemples</a></li>
                                <li><code>product</code> : <a href="#formulas_variables_product">variables</a></li>
                                <li><code>product.attribute.*</code> : <a href="#formulas_variables_product">variables</a></li>
                                <li><code>product.categories</code> : <a href="#formulas_variables_product">variables</a>, <a href="#examples_product_categories">exemples</a></li>
                                <li>propriété : <a href="#definitions_property">définition</a></li>
                            </ul>

                            <h3>Q</h3>
                            <ul>
                                <li><code>quote</code> : <a href="#formulas_variables_quote">variables</a></li>
                            </ul>

                            <h3>R</h3>
                            <ul>
                                <li><code>request</code> : <a href="#formulas_variables_request">variables</a></li>
                            </ul>

                            <h3>S</h3>
                            <ul>
                                <li><code>shipto</code> :
                                    <ul>
                                        <li><a href="#property_shipto">propriété</a>, <a href="#examples_using_address_filters">exemples</a></li>
                                        <li><a href="#formulas_variables_shipto">variables</a></li>
                                    </ul>
                                </li>
                                <li><code>store</code> : <a href="#formulas_variables_store">variables</a></li>
                                <li><code>sum</code> : <a href="#formulas_special_functions">fonction spéciale</a></li>
                                <li><code>switch</code> : <a href="#formulas_special_functions">fonction spéciale</a>, <a href="#examples_special_switch">exemples</a></li>
                            </ul>

                            <h3>T</h3>
                            <ul>
                                <li><code>table</code> : <a href="#formulas_special_functions">fonction spéciale</a>, <a href="#examples_special_table">exemples</a></li>
                                <li>table de correspondance&nbsp;: voir <code>switch</code></li>
                                <li>titre&nbsp;: voir <code>label</code></li>
                                <li><code>tracking_url</code>&nbsp;: <a href="#property_tracking_url">propriété</a>, <a href="#more_tracking_url">plus d'informations</a></li>
                                <li><code>type</code>&nbsp;: <a href="#property_type">propriété</a></li>
                            </ul>

                            <h3>U</h3>
                            <ul>
                                <li>URL de suivi&nbsp;: voir <code>tracking_url</code></li>
                            </ul>

                            <h3>V</h3>
                            <ul>
                                <li>Variables : <a href="#formulas_variables">disponibles</a>, <a href="#formulas_deprecated_variables">dépréciées</a></li>
                                <li>Variables personnalisées de Magento : voir <code>customvar</code></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <!-- doc content end -->
        </div>
    </div>
</div>
<script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.0-rc1/js/bootstrap.min.js"></script>
<script>
<!-- doc scripts start -->
function jsonEncode(data, beautify, html, level, current_indent) {
    if (typeof beautify == 'undefined') beautify = false;
    if (typeof html == 'undefined') html = false;
    if (typeof level == 'undefined') level = 0;
    if (typeof current_indent == 'undefined') current_indent = '';

    var indent = html ? '&nbsp;&nbsp;&nbsp;' : "\t";
    var line_break = html ? '<br/>' : "\n";
    var new_indent = current_indent + indent;
    switch (typeof(data)) {
        case 'undefined':
            return (html ? '<span class=json-reserved>' : '') + 'null' + (html ? '</span>' : '');
        case 'boolean':
            return (html ? '<span class=json-reserved>' : '') + (data ? 'true' : 'false') + (html ? '</span>' : '');
        case 'number':
            return (html ? '<span class=json-numeric>' : '') + data + (html ? '</span>' : '');
        case 'string':
            var output = JSON.stringify(data);
            return html ? '<span class=json-string>' + output + '</span>' : output;
        case 'object':
            var output_index_count = 0;
            var output = [];
            for (var key in data) {
                var value = data[key];
                if (output_index_count!==null && output_index_count++!==key) {
                    output_index_count = null;
                }
            }
            var is_associative = output_index_count===null;
            for (var key in data) {
                var value = data[key];
                if (is_associative) {
                    var classes = [];
                    if (key=='about') classes.push('json-about');
                    if (key=='conditions' || key=='fees') classes.push('json-formula');
                    var property_classes = ['json-property'];
                    if (level==0) property_classes.push('json-id');
                    output.push(
                        (html && classes.length ? '<span class="' + classes.join(' ') + '">' : '')
                        + (html ? '<span' + (property_classes.length ? ' class="' + property_classes.join(' ') + '"' : '') + '>' : '')
                        + jsonEncode('' + key)
                        + (html ? '</span>' : '') + ':'
                        + (beautify ? ' ' : '')
                        + jsonEncode(value, beautify, html, level+1, new_indent)
                        + (html && classes.length ? '</span>' : '')
                    );
                } else {
                    output.push(jsonEncode(value, beautify, html, level+1, current_indent));
                }
            }
            if (is_associative) {
                var classes = [];
                if (data.type == 'meta') classes.push('json-meta');
                output = (html && classes.length ? '<span class="' + classes.join(' ') + '">' : '')
                    + '{'
                    + (beautify ? line_break + new_indent : '')
                    + output.join(',' + (beautify ? line_break + new_indent : ''))
                    + (beautify ? line_break + current_indent : '')
                    + '}'
                    + (html && classes.length ? '</span>' : '');
                return output;
            } else {
                return '[' + output.join(',' + (beautify ? ' ' : '')) + ']';
            }
        default:
            return ''; // Not supported
    }
}

$(function(){
    var navHeight = $('.navbar').outerHeight(true) + 10;

    $('a[href^="#"]').click(function (e) {
        $('.highlight').removeClass('highlight');
        var anchor = $(this).attr('href').replace('#', '');
        window.location.hash = '#' + anchor;
        var jelem = $('#' + anchor);
        jelem.addClass('highlight');
        $('body,html').scrollTop(Math.round(jelem.offset().top - navHeight + 10));
        e.preventDefault()
    });

    $('a[href^="#"]').each(function (e) {
        var anchor = $(this).attr('href').replace('#', '');
        if (anchor == '') return;
        var jelem = $('#' + anchor);
        if (!jelem.length) {
            $(this).css('border', 'solid 1px red').css('padding', 3);
        }
    });

    var index = 0;
    $('div.json').each(function(){
        var text = $(this).text();
        while (text.match(/"__auto__"/)) {
            text = text.replace(/"__auto__"/, '"id_' + ('000' + index).slice(-3) + '"');
            index++;
        }
        var obj = $.parseJSON(text);
        var beautified = jsonEncode(obj, true, true);
        $(this).html('<pre>' + beautified + '</pre>');
        $(this).addClass('code');
    });
    $('body').scrollspy({
        target: '.sidebar',
        offset: navHeight
    });

});
<!-- doc scripts end -->

</script>
</body>
</html>